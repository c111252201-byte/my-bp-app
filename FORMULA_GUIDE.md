# 判斷函數輸入指南

## 錯誤訊息
如果看到錯誤：「判斷函數計算失敗: Invalid left-hand side in assignment」，表示公式格式不正確。

## 正確的公式格式

在 Google Sheets 的「工作表二」的 **C2** 儲存格中，請按照以下格式輸入判斷函數：

### ✅ 正確格式（不包含等號）

直接在 C2 儲存格輸入公式，**不要加等號**：

```
x + y
```

或

```
x * 2 + y
```

或

```
(x + y) / 2
```

### ❌ 錯誤格式

**不要**使用 Google Sheets 公式格式（帶等號）：

```
=x + y          ❌ 錯誤
=x*2+y          ❌ 錯誤
=SUM(x,y)       ❌ 錯誤
```

## 變數說明

- **x** = 舒張壓（系統會自動代入檢測到的舒張壓數值）
- **y** = 收縮壓（系統會自動代入檢測到的收縮壓數值）

## 公式範例

### 範例 1：簡單相加
```
x + y
```
這會計算：舒張壓 + 收縮壓

### 範例 2：加權計算
```
x * 0.6 + y * 0.4
```
這會計算：舒張壓 × 0.6 + 收縮壓 × 0.4

### 範例 3：平均值
```
(x + y) / 2
```
這會計算：(舒張壓 + 收縮壓) ÷ 2

### 範例 4：複雜公式
```
x * 2 + y - 10
```
這會計算：舒張壓 × 2 + 收縮壓 - 10

## 支援的運算符

- `+` 加法
- `-` 減法
- `*` 乘法
- `/` 除法
- `()` 括號（用於改變運算順序）

## 設定步驟

1. 開啟您的 Google Sheets
2. 切換到「工作表二」
3. 在 **C2** 儲存格中輸入公式（**不要加等號**）
   - 例如：輸入 `x + y`
4. 在 **B7** 儲存格中輸入基準值（數字）
   - 例如：輸入 `10`
5. 儲存 Google Sheets

## 常見問題

### Q: 為什麼不能加等號？
A: 系統會自動處理公式，如果加上等號會導致計算錯誤。

### Q: 可以使用 Google Sheets 函數嗎（如 SUM、AVERAGE）？
A: 目前不支援 Google Sheets 內建函數，只能使用基本的數學運算符（+、-、*、/）。

### Q: 公式計算結果如何判斷？
A: 系統會：
1. 將 x 和 y 代入公式計算結果
2. 計算 `|結果 - y|`（結果減去收縮壓的絕對值）
3. 與 B7 的基準值比較
4. 如果差值 ≤ B7：顯示「正常」
5. 如果差值 > B7：顯示「不正常」

### Q: 如果公式還是無法運作？
A: 請檢查：
1. 公式中只包含 x、y 和數學運算符
2. 沒有等號
3. 括號配對正確
4. 查看瀏覽器主控台的詳細錯誤訊息

## 測試建議

輸入公式後，可以先用簡單的數值測試：
- 假設 x = 80（舒張壓）
- 假設 y = 120（收縮壓）
- 公式：`x + y`
- 計算結果：80 + 120 = 200
- 差值：|200 - 120| = 80
- 如果 B7 = 10，則 80 > 10，顯示「不正常」
- 如果 B7 = 100，則 80 ≤ 100，顯示「正常」





